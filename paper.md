---
title: 'ztfquery: python package to access Zwicky Transient Facility data'
tags:
  - Python
  - astronomy
  - ztf
authors:
  - name: Mickael Rigault
    orcid: 0000-0002-8121-2560
    affiliation: 1 
affiliations:
 - name:  Universite Clermont Auvergne, CNRS/IN2P3, Laboratoire de Physique de Clermont, F-63000 Clermont-Ferrand, France.
   index: 1
date: 1 March 2020
bibliography: paper.bib


# Optional fields if submitting to a AAS journal too, see this blog post:
---

# Summary

`ztfquery` is a python package built to download data generated by the Zwicky Transient Facility (ZTF, @bellm:2019; @graham:2019). It bascially is a python wrapper of [ZTF's web API IRSA service](https://irsa.ipac.caltech.edu/docs/program_interface/ztf_api.html).

## ZTF products
`ztfquery.query` is the core of `ztfquery` and enables you to access images and catalogs produced by the ZTF camera, installed on the Palomar P48 telescope. These data are produced by the ZTF pipeline detailed in @masci:2019. 

Accessing the data needs two steps. First it loads metadata associated to your query and second it allows you to download the data you want. This first step is needed to know how to build the IRSA url from where the data are downloaded. 

For example, say you want the PSF catalog generated for the images that contain the coordiate RA=276.107960, Dec=+44.130398, observed with seeing lower than 2 since 14th of May 2018.

Then, first let's load the metadata associated to this particular query:
```python
from ztfquery import query
zquery = query.ZTFQuery()

# Step 1, load the meta data (NB: Julian Date of 14th of May 2018 is 2458252.
zquery.load_metadata(radec=[276.107960,+44.130398], size=0.01, 
                     sql_query="seeing<2 and obsjd>2458252.5")
```
The IRSA metadata are stored as `metatable` and contains information like observation date, filter ID, ccd ID etc. See details [on IRSA's API](https://irsa.ipac.caltech.edu/docs/program_interface/ztf_api.html)

Once you have your metadata, `ztfquery` is able to build the url you want and download the data on your computer. 

Simply do:
```python
zquery.download_data("psfcat.fits", show_progress=False)
```

See package [README](https://github.com/MickaelRigault/ztfquery) for additional examples.

## Other tools

In addition, other tools are available inside ztfquery that enables to access other data source. Most are private and requires access. These are:
 IPAC | requires access)_)

- **Marshal Data:** tools to download [Marshal](http://skipper.caltech.edu:8080/cgi-bin/growth/marshal.cgi) data, including alert lightcurves and target coordinates _(requires access)_

- **SEDM Data:** tools to download SEDM data, including IFU cubes and target spectra, from [pharos](http://pharos.caltech.edu) _(requires access)_

- **ZTF alert:** Currently only a simple alert reader.


# Acknowledgements

This software development has received funding from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation programme (grant agreement nÂ°759194 - USNAC)

# References
